# AgroDetect AI - System Architecture

## ğŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERFACE                        â”‚
â”‚                    (Streamlit Web App)                       â”‚
â”‚                   http://localhost:8501                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APPLICATION LAYER                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Disease    â”‚  â”‚  Analytics   â”‚  â”‚    About     â”‚     â”‚
â”‚  â”‚Classificationâ”‚  â”‚  Dashboard   â”‚  â”‚     Page     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   INFERENCE ENGINE                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ Load Model (H5 or TFLite)                         â”‚  â”‚
â”‚  â”‚  â€¢ Warm-up for reduced latency                       â”‚  â”‚
â”‚  â”‚  â€¢ Single/Batch prediction                           â”‚  â”‚
â”‚  â”‚  â€¢ Confidence scoring                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 IMAGE PREPROCESSING                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ Resize to 224x224                                 â”‚  â”‚
â”‚  â”‚  â€¢ Normalize pixels [-1, 1]                          â”‚  â”‚
â”‚  â”‚  â€¢ Color space conversion                            â”‚  â”‚
â”‚  â”‚  â€¢ Batch processing                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI MODEL LAYER                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              MobileNetV2 Architecture                â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  Input (224x224x3)                                   â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  MobileNetV2 Base (Pre-trained on ImageNet)         â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  Global Average Pooling                              â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  Dense (256, ReLU)                                   â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  Dropout (0.5)                                       â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  Output (25, Softmax)                                â”‚  â”‚
â”‚  â”‚       â†“                                              â”‚  â”‚
â”‚  â”‚  Probability Distribution                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚    Model     â”‚  â”‚    Class     â”‚  â”‚   Training   â”‚     â”‚
â”‚  â”‚   Weights    â”‚  â”‚    Names     â”‚  â”‚   History    â”‚     â”‚
â”‚  â”‚   (.h5)      â”‚  â”‚   (.json)    â”‚  â”‚   (.json)    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow

### 1. Image Upload Flow

```
User Browser
    â”‚
    â”‚ [Upload leaf.jpg]
    â†“
Streamlit File Uploader
    â”‚
    â”‚ [File object]
    â†“
PIL Image.open()
    â”‚
    â”‚ [PIL Image]
    â†“
numpy.array()
    â”‚
    â”‚ [numpy array: HxWx3]
    â†“
InferenceEngine.predict_single()
    â”‚
    â”‚ [Raw image array]
    â†“
ImagePreprocessor.preprocess_single()
    â”‚
    â”œâ”€â†’ Resize to 224x224
    â”œâ”€â†’ Normalize to [-1, 1]
    â””â”€â†’ [Preprocessed: 224x224x3]
    â†“
np.expand_dims() [Add batch dimension]
    â”‚
    â”‚ [Batch: 1x224x224x3]
    â†“
model.predict()
    â”‚
    â”‚ [Neural network inference]
    â†“
Softmax Output
    â”‚
    â”‚ [Probabilities: 25 classes]
    â†“
PredictionResult
    â”‚
    â”œâ”€â†’ disease_class: "Tomato___Early_blight"
    â”œâ”€â†’ confidence: 87.5
    â”œâ”€â†’ probability_distribution: {...}
    â”œâ”€â†’ inference_time_ms: 125.3
    â””â”€â†’ low_confidence_flag: False
    â†“
Streamlit Display
    â”‚
    â””â”€â†’ User sees results
```

### 2. Training Flow

```
Dataset Directory
    â”‚
    â”œâ”€â†’ Tomato___Early_blight/
    â”œâ”€â†’ Tomato___Late_blight/
    â”œâ”€â†’ Tomato___healthy/
    â””â”€â†’ ...
    â†“
TrainingManager.prepare_dataset()
    â”‚
    â”œâ”€â†’ Load images from directories
    â”œâ”€â†’ Split train/validation (80/20)
    â”œâ”€â†’ Normalize pixels
    â”œâ”€â†’ Create tf.data.Dataset
    â””â”€â†’ Apply augmentation
    â†“
DiseaseClassifier.build_model()
    â”‚
    â”œâ”€â†’ Load MobileNetV2 (ImageNet weights)
    â”œâ”€â†’ Freeze base layers
    â”œâ”€â†’ Add custom classification head
    â””â”€â†’ Compile with Adam optimizer
    â†“
TrainingManager.train()
    â”‚
    â”œâ”€â†’ Forward pass (compute predictions)
    â”œâ”€â†’ Calculate loss
    â”œâ”€â†’ Backward pass (update weights)
    â”œâ”€â†’ Validate on validation set
    â”œâ”€â†’ Apply callbacks (early stopping, LR reduction)
    â””â”€â†’ Save best model
    â†“
Trained Model
    â”‚
    â”œâ”€â†’ models/plant_disease_model.h5
    â”œâ”€â†’ models/class_names.json
    â””â”€â†’ models/training_history.json
```

## ğŸ“ File Structure

```
agrodetect-ai/
â”‚
â”œâ”€â”€ src/                          # Source code
â”‚   â”œâ”€â”€ models/                   # AI models
â”‚   â”‚   â”œâ”€â”€ disease_classifier.py # MobileNetV2 architecture
â”‚   â”‚   â””â”€â”€ training_manager.py   # Training pipeline
â”‚   â”‚
â”‚   â”œâ”€â”€ inference/                # Inference engine
â”‚   â”‚   â””â”€â”€ inference_engine.py   # Real-time predictions
â”‚   â”‚
â”‚   â”œâ”€â”€ preprocessing/            # Image processing
â”‚   â”‚   â”œâ”€â”€ image_preprocessor.py # Resize, normalize
â”‚   â”‚   â””â”€â”€ augmentation_pipeline.py # Data augmentation
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                     # Data management
â”‚   â”‚   â””â”€â”€ dataset_manager.py    # Dataset organization
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                       # User interface
â”‚   â”‚   â””â”€â”€ app.py                # Streamlit application
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # Utilities
â”‚       â””â”€â”€ logger.py             # Logging system
â”‚
â”œâ”€â”€ models/                       # Trained models
â”‚   â”œâ”€â”€ plant_disease_model.h5    # Model weights
â”‚   â”œâ”€â”€ class_names.json          # Disease classes
â”‚   â””â”€â”€ checkpoints/              # Training checkpoints
â”‚
â”œâ”€â”€ data/                         # Data storage
â”‚   â”œâ”€â”€ raw/                      # Raw images
â”‚   â”œâ”€â”€ processed/                # Processed datasets
â”‚   â””â”€â”€ manifests/                # Dataset metadata
â”‚
â”œâ”€â”€ config/                       # Configuration
â”‚   â””â”€â”€ config.yaml               # System settings
â”‚
â”œâ”€â”€ logs/                         # Application logs
â”‚
â”œâ”€â”€ tests/                        # Test suite
â”‚   â””â”€â”€ test_*.py                 # Unit and property tests
â”‚
â”œâ”€â”€ venv/                         # Virtual environment
â”‚
â”œâ”€â”€ train_model.py                # Training script
â”œâ”€â”€ download_pretrained_model.py  # Model setup
â”œâ”€â”€ requirements.txt              # Dependencies
â”œâ”€â”€ README.md                     # Project overview
â”œâ”€â”€ AI_USAGE_GUIDE.md            # Usage documentation
â”œâ”€â”€ QUICK_START.md               # Quick start guide
â””â”€â”€ IMPLEMENTATION_SUMMARY.md    # Implementation details
```

## ğŸ§© Component Interactions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Streamlit App (app.py)                    â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Home     â”‚  â”‚  Classify  â”‚  â”‚ Analytics  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚        â”‚               â”‚               â”‚                     â”‚
â”‚        â”‚               â”‚               â”‚                     â”‚
â”‚        â”‚         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”         â”‚                     â”‚
â”‚        â”‚         â”‚  Upload   â”‚         â”‚                     â”‚
â”‚        â”‚         â”‚   Image   â”‚         â”‚                     â”‚
â”‚        â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚                     â”‚
â”‚        â”‚               â”‚               â”‚                     â”‚
â”‚        â”‚               â†“               â”‚                     â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                     â”‚
â”‚        â”‚      â”‚ InferenceEngineâ”‚â†â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚        â”‚               â”‚                                     â”‚
â”‚        â”‚               â†“                                     â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚        â”‚      â”‚ImagePreprocessorâ”‚                            â”‚
â”‚        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚        â”‚               â”‚                                     â”‚
â”‚        â”‚               â†“                                     â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚        â”‚      â”‚  AI Model      â”‚                             â”‚
â”‚        â”‚      â”‚  (MobileNetV2) â”‚                             â”‚
â”‚        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚        â”‚               â”‚                                     â”‚
â”‚        â”‚               â†“                                     â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚        â”‚      â”‚ Prediction     â”‚                             â”‚
â”‚        â”‚      â”‚ Result         â”‚                             â”‚
â”‚        â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚        â”‚               â”‚                                     â”‚
â”‚        â”‚               â†“                                     â”‚
â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”¤   Display      â”‚                             â”‚
â”‚               â”‚   Results      â”‚                             â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security & Performance

### Security Measures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Security Layers                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Input Validation                     â”‚
â”‚    â€¢ File type checking (JPEG/PNG/BMP)  â”‚
â”‚    â€¢ File size limits                   â”‚
â”‚    â€¢ Image format validation            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Error Handling                       â”‚
â”‚    â€¢ Try-catch blocks                   â”‚
â”‚    â€¢ Graceful degradation               â”‚
â”‚    â€¢ User-friendly error messages       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Resource Management                  â”‚
â”‚    â€¢ Memory cleanup                     â”‚
â”‚    â€¢ Model caching                      â”‚
â”‚    â€¢ Batch size limits                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Optimization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Performance Optimizations           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Model Caching                        â”‚
â”‚    â€¢ @st.cache_resource decorator       â”‚
â”‚    â€¢ Load model once                    â”‚
â”‚    â€¢ Reuse across requests              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Model Warm-up                        â”‚
â”‚    â€¢ Pre-run inference                  â”‚
â”‚    â€¢ Reduce first-request latency       â”‚
â”‚    â€¢ 5-10 dummy predictions             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Image Preprocessing                  â”‚
â”‚    â€¢ Efficient resizing (OpenCV)        â”‚
â”‚    â€¢ Vectorized operations (NumPy)      â”‚
â”‚    â€¢ Batch processing support           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. TensorFlow Optimizations             â”‚
â”‚    â€¢ Graph optimization                 â”‚
â”‚    â€¢ Mixed precision (optional)         â”‚
â”‚    â€¢ TFLite for edge devices            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Pipeline

### Training Data Pipeline

```
Raw Images
    â†“
[Validation]
    â”œâ”€â†’ Check format (JPEG/PNG/BMP)
    â”œâ”€â†’ Check size (min 224x224)
    â””â”€â†’ Check corruption
    â†“
[Organization]
    â”œâ”€â†’ Group by disease class
    â”œâ”€â†’ Create directory structure
    â””â”€â†’ Generate metadata
    â†“
[Preprocessing]
    â”œâ”€â†’ Resize to 224x224
    â”œâ”€â†’ Normalize pixels
    â””â”€â†’ Convert color space
    â†“
[Augmentation]
    â”œâ”€â†’ Random rotation (Â±20Â°)
    â”œâ”€â†’ Random flip (H/V)
    â”œâ”€â†’ Random zoom (0.8-1.2x)
    â”œâ”€â†’ Random brightness (Â±20%)
    â””â”€â†’ Gaussian noise
    â†“
[Batching]
    â”œâ”€â†’ Create batches (32 images)
    â”œâ”€â†’ Shuffle data
    â””â”€â†’ Prefetch for performance
    â†“
Training Dataset
```

### Inference Data Pipeline

```
User Image
    â†“
[Upload]
    â””â”€â†’ Streamlit file uploader
    â†“
[Validation]
    â”œâ”€â†’ Check format
    â”œâ”€â†’ Check size
    â””â”€â†’ Load with PIL
    â†“
[Preprocessing]
    â”œâ”€â†’ Convert to numpy array
    â”œâ”€â†’ Resize to 224x224
    â”œâ”€â†’ Normalize to [-1, 1]
    â””â”€â†’ Add batch dimension
    â†“
[Inference]
    â”œâ”€â†’ Forward pass through model
    â”œâ”€â†’ Get probability distribution
    â””â”€â†’ Track inference time
    â†“
[Post-processing]
    â”œâ”€â†’ Extract top prediction
    â”œâ”€â†’ Calculate confidence
    â”œâ”€â†’ Sort alternatives
    â””â”€â†’ Flag low confidence
    â†“
Results Display
```

## ğŸ¯ System States

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         System State Diagram             â”‚
â”‚                                          â”‚
â”‚  [Initial]                               â”‚
â”‚      â†“                                   â”‚
â”‚  Load Config                             â”‚
â”‚      â†“                                   â”‚
â”‚  Initialize Model â”€â”€â†’ [Error] â”€â”€â†’ Show Error
â”‚      â†“                                   â”‚
â”‚  [Model Loaded]                          â”‚
â”‚      â†“                                   â”‚
â”‚  Warm-up Model                           â”‚
â”‚      â†“                                   â”‚
â”‚  [Ready]                                 â”‚
â”‚      â†“                                   â”‚
â”‚  Wait for Upload                         â”‚
â”‚      â†“                                   â”‚
â”‚  [Image Uploaded]                        â”‚
â”‚      â†“                                   â”‚
â”‚  Preprocess â”€â”€â†’ [Error] â”€â”€â†’ Show Error   â”‚
â”‚      â†“                                   â”‚
â”‚  Predict â”€â”€â†’ [Error] â”€â”€â†’ Show Error      â”‚
â”‚      â†“                                   â”‚
â”‚  [Results Ready]                         â”‚
â”‚      â†“                                   â”‚
â”‚  Display Results                         â”‚
â”‚      â†“                                   â”‚
â”‚  [Ready] (loop back)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Deployment Architecture

### Local Development

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Developer Machine           â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Streamlit Server          â”‚ â”‚
â”‚  â”‚  Port: 8501                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Python Virtual Env        â”‚ â”‚
â”‚  â”‚  â€¢ TensorFlow 2.15         â”‚ â”‚
â”‚  â”‚  â€¢ Streamlit 1.31          â”‚ â”‚
â”‚  â”‚  â€¢ OpenCV 4.8              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Local File System         â”‚ â”‚
â”‚  â”‚  â€¢ models/                 â”‚ â”‚
â”‚  â”‚  â€¢ data/                   â”‚ â”‚
â”‚  â”‚  â€¢ logs/                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Production Deployment (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Load Balancer                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”
â”‚ Server â”‚      â”‚ Server â”‚
â”‚   1    â”‚      â”‚   2    â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Model Store   â”‚
    â”‚  (S3/GCS/Azure) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Architecture Version**: 1.0  
**Last Updated**: February 2026  
**Status**: Production-Ready
